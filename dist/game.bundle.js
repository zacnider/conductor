/*! For license information please see game.bundle.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function a(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function s(n,a,r,i){var s=a&&a.prototype instanceof l?a:l,u=Object.create(s.prototype);return o(u,"_invoke",function(n,a,r){var o,i,s,l=0,u=r||[],d=!1,h={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,i=0,s=e,h.n=n,c}};function m(n,a){for(i=n,s=a,t=0;!d&&l&&!r&&t<u.length;t++){var r,o=u[t],m=h.p,y=o[2];n>3?(r=y===a)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=m&&((r=n<2&&m<o[1])?(i=0,h.v=a,h.n=o[1]):m<y&&(r=n<3||o[0]>a||a>y)&&(o[4]=n,o[5]=a,h.n=y,i=0))}if(r||n>1)return c;throw d=!0,a}return function(r,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,y),i=u,s=y;(t=i<2?e:s)||!d;){o||(i?i<3?(i>1&&(h.n=-1),m(i,s)):h.n=s:h.v=s);try{if(l=2,o){if(i||(r="next"),t=o[r]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((t=(d=h.n<0)?s:n.call(a,h))!==c)break}catch(t){o=e,i=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var c={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var h=[][a]?t(t([][a]())):(o(t={},a,function(){return this}),t),m=d.prototype=l.prototype=Object.create(h);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=d,o(m,"constructor",d),o(d,"constructor",u),u.displayName="GeneratorFunction",o(d,i,"GeneratorFunction"),o(m),o(m,i,"Generator"),o(m,a,function(){return this}),o(m,"toString",function(){return"[object Generator]"}),(r=function(){return{w:s,m:y}})()}function o(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}o=function(e,t,n,a){if(t)r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n;else{var i=function(t,n){o(e,t,function(e){return this._invoke(t,n,e)})};i("next",0),i("throw",1),i("return",2)}},o(e,t,n,a)}function i(e,t,n,a,r,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(a,r)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var o=e.apply(t,n);function s(e){i(o,a,r,s,c,"next",e)}function c(e){i(o,a,r,s,c,"throw",e)}s(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(s.push(a.value),s.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,m(a.key),a)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function y(t,n,a){return n=v(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,p()?Reflect.construct(n,a||[],v(t).constructor):n.apply(t,a))}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(p=function(){return!!e})()}function f(e,t,n,a){var r=g(v(1&a?e.prototype:e),t,n);return 2&a&&"function"==typeof r?function(e){return r.apply(n,e)}:r}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var a=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(a){var r=Object.getOwnPropertyDescriptor(a,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},g.apply(null,arguments)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}var S=function(){function e(){return u(this,e),y(this,e,arguments)}return b(e,Multisynq.Model),h(e,[{key:"init",value:function(t){f(e,"init",this,3)([t]),this.gameState={players:{},scores:{},currentTask:null,round:0,gameStarted:!1,gameEnded:!1,roomId:null},console.log("ChaosGameModel initialized:",this.sessionId),this.subscribe(this.sessionId,"view-join",this.onViewJoin),this.subscribe(this.sessionId,"view-exit",this.onViewExit),this.subscribe(this.sessionId,"taskComplete",this.handleTaskCompleted),this.subscribe(this.sessionId,"gameStateUpdate",this.handleGameStateUpdate),this.subscribe(this.sessionId,"newTask",this.handleNewTask),this.subscribe(this.sessionId,"sabotageUse",this.handleSabotageUsed),this.subscribe(this.sessionId,"chatMessage",this.handleChatMessage)}},{key:"onViewJoin",value:function(e){if(console.log("Player ".concat(e," trying to join...")),Object.keys(this.gameState.players).length>=8)return this.publish(e,"connection-refused",{reason:"Server is full",maxPlayers:8,currentPlayers:Object.keys(this.gameState.players).length}),void console.log("Player ".concat(e," refused - server full"));console.log("Player ".concat(e," joined the game!")),this.subscribe(e,"set-name","handleSetName"),this.gameState.players[e]={id:e,name:"Player".concat(Object.keys(this.gameState.players).length+1),ready:!1,combo:0},this.gameState.scores[e]=0;var t=Object.keys(this.gameState.players).length;console.log("Player joined:",e,"Total players:",t),this.publish(this.sessionId,"playersUpdate",{players:this.gameState.players,scores:this.gameState.scores,playerCount:t})}},{key:"onViewExit",value:function(e){if(console.log("Player ".concat(e," left")),this.gameState.players[e]){delete this.gameState.players[e],delete this.gameState.scores[e];var t=Object.keys(this.gameState.players).length;this.publish(this.sessionId,"playersUpdate",{players:this.gameState.players,scores:this.gameState.scores,playerCount:t}),console.log("Player left, remaining players:",t)}}},{key:"handleSetName",value:function(e){var t=e.viewId,n=e.name;this.gameState.players[t]&&(this.gameState.players[t].name=n.substring(0,15),this.publish(this.sessionId,"playersUpdate",{players:this.gameState.players,scores:this.gameState.scores,playerCount:Object.keys(this.gameState.players).length}))}},{key:"handleTaskCompleted",value:function(e){var t=e.playerId,n=e.taskId,a=e.timeLeft,r=e.success;if(this.gameState.currentTask&&this.gameState.currentTask.id===n){var o=this.gameState.players[t];if(o&&r){var i=this.gameState.currentTask.points,s=10*Math.floor(a/1e3);i+=s,o.combo=(o.combo||0)+1,o.combo>=3&&(i*=1.5,o.combo=0,this.publish("powerUp",{playerId:t,type:"combo"}));var c=this.gameState.scores[t]||0;this.gameState.scores[t]=c+i,this.publish("scoreUpdate",{playerId:t,points:i,speedBonus:s,totalScore:c+i})}}}},{key:"handleGameStateUpdate",value:function(e){Object.assign(this.gameState,e),this.publish("gameStateChanged",this.gameState)}},{key:"handleNewTask",value:function(e){this.gameState.currentTask=e.task,this.gameState.round=e.round,this.publish("taskUpdate",e)}},{key:"handleSabotageUsed",value:function(e){this.publish("sabotageActivated",e)}},{key:"handleChatMessage",value:function(e){this.publish("chatUpdate",e)}}])}(),w=function(){function e(){return u(this,e),y(this,e,arguments)}return b(e,Multisynq.View),h(e,[{key:"init",value:function(t){var n=this;f(e,"init",this,3)([t]),this.model=t,this.gameState={players:{},scores:{},currentTask:null,round:0,gameStarted:!1,gameEnded:!1,roomId:null},this.currentPlayerId=this.viewId,this.playerName="",this.isFrozen=!1,console.log("ChaosGameView initialized:",this.sessionId,this.viewId),this.subscribe(this.viewId,"connection-refused",function(e){return n.onConnectionRefused(e)}),this.subscribe(this.sessionId,"playersUpdate",function(e){return n.updatePlayers(e)}),this.subscribe(this.sessionId,"gameStateChanged",function(e){return n.updateGameState(e)}),this.subscribe(this.sessionId,"taskUpdate",function(e){return n.updateTask(e)}),this.subscribe(this.sessionId,"scoreUpdate",function(e){return n.updateScore(e)}),this.subscribe(this.sessionId,"powerUp",function(e){return n.showPowerUp(e)}),this.subscribe(this.sessionId,"sabotageActivated",function(e){return n.handleSabotage(e)}),this.subscribe(this.sessionId,"chatUpdate",function(e){return n.updateChat(e)}),this.startModelSync()}},{key:"startModelSync",value:function(){var e=this;setInterval(function(){if(e.model&&e.model.gameState){var t=e.model.gameState.players||{},n=e.model.gameState.scores||{},a=Object.keys(t).length;a>0&&0===Object.keys(e.gameState.players||{}).length&&(console.log("Syncing from Model - Players:",a),e.gameState.players=t,e.gameState.scores=n,e.renderPlayers(),e.renderScores())}},1e3)}},{key:"onConnectionRefused",value:function(e){var t=e.reason,n=e.maxPlayers,a=e.currentPlayers;console.log("Connection refused:",t),this.showNotification("Sunucu dolu! (".concat(a,"/").concat(n,")"),"error")}},{key:"updatePlayers",value:function(e){if(console.log("View updatePlayers called:",e),e&&e.players){this.gameState||(this.gameState={players:{},scores:{},currentTask:null,round:0,gameStarted:!1,gameEnded:!1,roomId:null}),this.gameState.players=e.players,this.gameState.scores=e.scores||{};var t=Object.keys(this.gameState.players).length;console.log("Updating UI with player count:",t),this.renderPlayers(),this.renderScores()}else console.warn("updatePlayers called with invalid data:",e)}},{key:"updateGameState",value:function(e){Object.assign(this.gameState,e),this.renderGameState()}},{key:"updateTask",value:function(e){this.gameState.currentTask=e.task,this.gameState.round=e.round,this.renderTask(),this.startTaskTimer()}},{key:"updateScore",value:function(e){e.playerId===this.currentPlayerId&&this.showScoreNotification(e.points,e.speedBonus),this.gameState.scores[e.playerId]=e.totalScore,this.renderScores()}},{key:"showPowerUp",value:function(e){e.playerId===this.currentPlayerId&&this.showNotification("🔥 COMBO BONUS! 🔥","success")}},{key:"handleSabotage",value:function(e){e.targetId===this.currentPlayerId&&this.freezePlayer(e.duration),this.showNotification("".concat(e.playerName," sabotaj kullandı!"),"warning")}},{key:"updateChat",value:function(e){this.addChatMessage(e)}},{key:"renderPlayers",value:function(){var e=document.getElementById("players-list");if(e){this.gameState&&this.gameState.players||(console.warn("gameState or players is undefined"),this.gameState=this.gameState||{players:{},scores:{},currentTask:null,round:0,gameStarted:!1,gameEnded:!1,roomId:null},this.gameState.players=this.gameState.players||{}),e.innerHTML="";var t=Object.keys(this.gameState.players).length;Object.entries(this.gameState.players).forEach(function(t){var n=c(t,2),a=(n[0],n[1]);if(a){var r=document.createElement("div");r.className="player-card",a.ready&&r.classList.add("ready"),r.innerHTML='\n                <div class="player-name">'.concat(a.name||"Unknown",'</div>\n                <div class="player-status">').concat(a.ready?"Hazır":"Bekliyor","</div>\n            "),e.appendChild(r)}});var n=document.getElementById("player-count");n&&(n.textContent=t);var a=document.getElementById("start-game-btn");a&&(t>=2?(a.disabled=!1,a.textContent="OYUNU BAŞLAT",a.style.opacity="1"):(a.disabled=!0,a.textContent="OYUNU BAŞLAT (".concat(t,"/2)"),a.style.opacity="0.5")),console.log("Players rendered:",t,"players")}}},{key:"renderScores",value:function(){var e=this,t=document.getElementById("scores-list");if(t){var n=Object.entries(this.gameState.scores).sort(function(e,t){return t[1]-e[1]});t.innerHTML="",n.forEach(function(n,a){var r=c(n,2),o=r[0],i=r[1],s=e.gameState.players[o];if(s){var l=document.createElement("div");l.className="score-item",o===e.currentPlayerId&&l.classList.add("current-player"),l.innerHTML="\n                <span>".concat(a+1,". ").concat(s.name,"</span>\n                <span>").concat(i,"</span>\n            "),t.appendChild(l)}})}}},{key:"renderTask",value:function(){var e=document.getElementById("task-description"),t=document.getElementById("current-round");e&&this.gameState.currentTask&&(e.textContent=this.gameState.currentTask.description,this.gameState.currentTask.isFake?(e.style.color="#ff6b6b",e.style.textDecoration="line-through"):(e.style.color="",e.style.textDecoration="")),t&&(t.textContent=this.gameState.round),this.renderTaskElements()}},{key:"renderTaskElements",value:function(){var e=document.getElementById("game-ui"),t=document.getElementById("game-canvas");if(e&&t&&this.gameState.currentTask){e.innerHTML="";var n=this.gameState.currentTask;switch(n.type){case"click":this.createClickElements(e,t,n);break;case"type":this.createTypeElements(e,n);break;case"draw":this.createDrawElements(t,n)}}}},{key:"createClickElements",value:function(e,t,n){for(var a=this,r=t.getBoundingClientRect(),o=["red","blue","green","yellow","purple","orange"],i=["circle","square","triangle"],s=n.targetColor||o[Math.floor(Math.random()*o.length)],c=n.targetShape||i[Math.floor(Math.random()*i.length)],l=5+Math.floor(6*Math.random()),u=function(){var t=document.createElement("div");t.className="game-element shape ".concat(i[Math.floor(Math.random()*i.length)]);var n=0===d?s:o[Math.floor(Math.random()*o.length)],l=0===d?c:i[Math.floor(Math.random()*i.length)];t.style.backgroundColor=n,t.style.width="60px",t.style.height="60px",t.style.left=Math.random()*(r.width-60)+"px",t.style.top=Math.random()*(r.height-60)+"px",t.addEventListener("click",function(){n!==s||l!==c||a.isFrozen?a.completeTask(!1):a.completeTask(!0)}),e.appendChild(t)},d=0;d<l;d++)u()}},{key:"createTypeElements",value:function(e,t){var n=this,a=document.createElement("div");a.style.position="absolute",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)",a.style.textAlign="center";var r=document.createElement("input");r.type="text",r.placeholder='"'.concat(t.targetWord,'" yazın...'),r.style.padding="15px",r.style.fontSize="1.2rem",r.style.borderRadius="10px",r.style.border="none",r.style.textAlign="center",r.style.width="300px";var o=0,i=t.targetCount||3;r.addEventListener("keypress",function(e){"Enter"!==e.key||n.isFrozen||r.value.toLowerCase()===t.targetWord.toLowerCase()&&(o++,r.value="",o>=i?n.completeTask(!0):r.placeholder='"'.concat(t.targetWord,'" yazın... (').concat(o,"/").concat(i,")"))}),a.appendChild(r),e.appendChild(a),setTimeout(function(){return r.focus()},100)}},{key:"createDrawElements",value:function(e,t){var n=this,a=e.getContext("2d"),r=!1,o=!1;a.strokeStyle="#fff",a.lineWidth=3,a.lineCap="round";var i=function(){r=!1,o&&setTimeout(function(){return n.completeTask(!0)},500)};e.addEventListener("mousedown",function(t){if(!n.isFrozen){r=!0,o=!0;var i=e.getBoundingClientRect();a.beginPath(),a.moveTo(t.clientX-i.left,t.clientY-i.top)}}),e.addEventListener("mousemove",function(t){if(r&&!n.isFrozen){var o=e.getBoundingClientRect();a.lineTo(t.clientX-o.left,t.clientY-o.top),a.stroke()}}),e.addEventListener("mouseup",i),e.addEventListener("mouseout",i)}},{key:"startTaskTimer",value:function(){var e=this,t=document.getElementById("task-timer"),n=document.querySelector(".progress-bar")||this.createProgressBar();if(t&&this.gameState.currentTask){var a=this.gameState.currentTask.duration/1e3,r=a,o=function(){t.textContent=Math.ceil(a);var i=a/r*100;n.style.width=i+"%",a<=0?e.completeTask(!1):(a-=.1,setTimeout(o,100))};o()}}},{key:"createProgressBar",value:function(){var e=document.getElementById("task-progress");if(!e)return null;var t=document.createElement("div");return t.className="progress-bar",t.style.width="100%",e.appendChild(t),t}},{key:"completeTask",value:function(e){if(this.gameState.currentTask){var t=document.getElementById("task-timer"),n=t?1e3*parseInt(t.textContent):0;this.publish("taskComplete",{playerId:this.currentPlayerId,taskId:this.gameState.currentTask.id,timeLeft:n,success:e}),e?(this.showNotification("Görev Tamamlandı! ✅","success"),this.playSound("task-complete")):(this.showNotification("Görev Başarısız! ❌","error"),this.playSound("task-fail"))}}},{key:"freezePlayer",value:function(e){var t=this;this.isFrozen=!0,document.body.classList.add("frozen");var n=document.createElement("div");n.className="sabotage-overlay",document.body.appendChild(n),this.showNotification("🧊 DONDURULDUN! 🧊","warning"),this.playSound("sabotage"),setTimeout(function(){t.isFrozen=!1,document.body.classList.remove("frozen"),n.remove()},e)}},{key:"showScoreNotification",value:function(e,t){var n="+".concat(e," puan!");t>0&&(n+=" (Hız bonusu: +".concat(t,")")),this.showNotification(n,"success")}},{key:"showNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("notifications");if(n){var a=document.createElement("div");a.className="notification ".concat(t),a.textContent=e,n.appendChild(a),setTimeout(function(){a.remove()},3e3)}}},{key:"addChatMessage",value:function(e){var t=document.getElementById("chat-messages");if(t){console.log("Adding chat message:",e);var n=document.createElement("div");n.className="chat-message",n.innerHTML='\n            <span class="sender">'.concat(e.playerName,":</span>\n            ").concat(e.message,"\n        "),t.appendChild(n),t.scrollTop=t.scrollHeight;var a=document.querySelector(".chat-container");a&&(a.style.display="flex")}else console.warn("Chat messages container not found")}},{key:"playSound",value:function(e){var t=document.getElementById(e+"-sound");t&&(t.currentTime=0,t.play().catch(function(e){return console.log("Ses çalınamadı:",e)}))}}])}();S.register("ChaosGameModel");var I=function(){return h(function e(){u(this,e),this.session=null,this.view=null,this.model=null,this.currentScreen="main-menu",this.playerName="",this.roomCode="",this.initializeUI(),this.loadLiveGames()},[{key:"initializeUI",value:function(){var e=this;document.getElementById("join-game-btn").addEventListener("click",function(){e.joinGame()}),document.getElementById("create-room-btn").addEventListener("click",function(){e.createRoom()}),document.getElementById("refresh-rooms-btn").addEventListener("click",function(){e.loadLiveGames()}),document.getElementById("start-game-btn").addEventListener("click",function(){e.startGame()}),document.getElementById("leave-room-btn").addEventListener("click",function(){e.leaveRoom()}),document.getElementById("send-chat-btn").addEventListener("click",function(){e.sendChatMessage()}),document.getElementById("chat-input").addEventListener("keypress",function(t){"Enter"===t.key&&e.sendChatMessage()}),document.getElementById("play-again-btn").addEventListener("click",function(){e.playAgain()}),document.getElementById("main-menu-btn").addEventListener("click",function(){e.goToMainMenu()})}},{key:"joinGame",value:(t=s(r().m(function e(){var t,n,a=this;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.playerName=document.getElementById("player-name").value.trim(),this.roomCode=document.getElementById("room-code").value.trim(),this.playerName){e.n=1;break}return this.showNotification("Lütfen oyuncu adınızı girin!","error"),e.a(2);case 1:return this.roomCode||(this.roomCode="default-room"),e.p=2,e.n=3,Multisynq.Session.join({apiKey:"2dNJ78OxelBvHA8vNqKR3r8Sf1W2RKELUYsuZo0whf",appId:"com.chaosconductor.game",name:this.roomCode,model:S,view:w,password:"chaos2025"});case 3:t=e.v,this.session=t,this.model=t.model,this.view=t.view,this.view.playerName=this.playerName,this.view.publish(this.view.viewId,"set-name",{viewId:this.view.viewId,name:this.playerName}),this.switchScreen("lobby"),this.updateRoomInfo(),setTimeout(function(){a.view.renderPlayers(),a.forceUpdatePlayerCount()},500),this.playerCountInterval=setInterval(function(){a.forceUpdatePlayerCount()},1e3),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Oyuna katılım hatası:",n.message||n),this.showNotification("Oyuna katılırken hata oluştu!","error");case 5:return e.a(2)}},e,this,[[2,4]])})),function(){return t.apply(this,arguments)})},{key:"createRoom",value:(e=s(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:return this.roomCode=this.generateRoomCode(),document.getElementById("room-code").value=this.roomCode,e.n=1,this.joinGame();case 1:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"generateRoomCode",value:function(){return Math.random().toString(36).substring(2,8).toUpperCase()}},{key:"startGame",value:function(){this.view&&Object.keys(this.view.gameState.players).length>=2&&(this.view.publish("gameStateUpdate",{gameMode:"playing",gameActive:!0}),this.switchScreen("game-screen"),this.startGameLoop())}},{key:"startGameLoop",value:function(){var e=this;setTimeout(function(){e.generateNewTask()},2e3)}},{key:"generateNewTask",value:function(){var e=this,t=[{type:"click",description:"Kırmızı daireye tıkla!",duration:1e4,points:100,targetColor:"red",targetShape:"circle"},{type:"type",description:"CHAOS yazın 3 kez!",duration:15e3,points:150,targetWord:"CHAOS",targetCount:3},{type:"draw",description:"5 saniyede bir ev çizin!",duration:8e3,points:200,targetObject:"house"},{type:"click",description:"Bu görev sahte, görmezden gelin!",duration:8e3,points:250,isFake:!0}],a=n(n({},t[Math.floor(Math.random()*t.length)]),{},{id:Date.now(),round:(this.view.gameState.round||0)+1});this.view.publish("newTask",{task:a,round:a.round}),setTimeout(function(){e.generateNewTask()},a.duration+2e3)}},{key:"leaveRoom",value:function(){this.view&&this.view.publish("playerLeave",{playerId:this.view.viewId}),this.switchScreen("main-menu"),this.resetGame()}},{key:"sendChatMessage",value:function(){var e=document.getElementById("chat-input"),t=e.value.trim();t&&this.view&&(this.view.publish("chatMessage",{playerId:this.view.viewId,playerName:this.playerName,message:t,timestamp:Date.now()}),e.value="")}},{key:"playAgain",value:function(){this.resetGame(),this.switchScreen("lobby")}},{key:"goToMainMenu",value:function(){this.leaveRoom()}},{key:"resetGame",value:function(){this.view&&(this.view.gameState={players:{},scores:{},currentTask:null,round:0,gameStarted:!1,gameEnded:!1,roomId:null})}},{key:"updateRoomInfo",value:function(){document.getElementById("room-name").textContent=this.roomCode,document.getElementById("current-room-code").textContent=this.roomCode}},{key:"switchScreen",value:function(e){document.querySelectorAll(".screen").forEach(function(e){e.classList.remove("active")}),document.getElementById(e).classList.add("active"),this.currentScreen=e}},{key:"showNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("notifications");if(n){var a=document.createElement("div");a.className="notification ".concat(t),a.textContent=e,n.appendChild(a),setTimeout(function(){a.remove()},3e3)}}},{key:"loadLiveGames",value:function(){var e=document.getElementById("live-games-list");e&&(e.innerHTML='<div class="loading">Aktif oyunlar yükleniyor...</div>')}},{key:"forceUpdatePlayerCount",value:function(){if(this.view&&this.view.gameState){this.view.gameState.players||(this.view.gameState.players={});var e=Object.keys(this.view.gameState.players).length,t=document.getElementById("player-count");t&&(t.textContent=e,console.log("Forced player count update:",e));var n=document.getElementById("start-game-btn");n&&(e>=2?(n.disabled=!1,n.textContent="OYUNU BAŞLAT",n.style.opacity="1"):(n.disabled=!0,n.textContent="OYUNU BAŞLAT (".concat(e,"/2)"),n.style.opacity="0.5")),this.view.renderPlayers()}}}]);var e,t}();document.addEventListener("DOMContentLoaded",function(){window.chaosGame=new I,console.log("Chaos Conductor başlatıldı! (Multisynq Mode)")})})();
//# sourceMappingURL=game.bundle.js.map